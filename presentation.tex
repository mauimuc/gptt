\documentclass[aspectratio=169, t, 10pt]{beamer}
\usetheme{Boadilla}
\beamertemplatenavigationsymbolsempty

\usepackage{standalone}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage{pgfplots}
\usepackage{mathtools}
\mathtoolsset{showonlyrefs}
\usepackage{qrcode}
\usepackage{multimedia}

\newcommand\Mean[1]{\mathbb{E}\!\left[#1\right]}
\newcommand\Var[1]{\mathbb{V}\!\left[#1\right]}
\newcommand\Cov[2]{\mathrm{Cov}\!\left[#1,#2\right]}
\newcommand\Gauss[2]{\mathcal{N}\!\left({#1},\,{#2}\right)}
\newcommand\GP[2]{\mathcal{GP}\!\left({#1},\,{#2}\right)}
\newcommand{\Identity}{\mathbb{I}}

\title[Correlation based travel time inversion]{Bayesian Travel Time Inversion adopting Gaussian Process Regression}
\subtitle{-- with the focus on uncertainty analysis --}
\author[\tt mauerber@uni-potsdam.de]{Stefan Mauerberger \and Matthias Holschneider}
\institute[Math@UP]{University Potsdam, Institute of Mathematics}
\titlegraphic{%\vspace{-1cm}
              \hspace{2cm}
              \parbox[c]{0.17\linewidth}{\includegraphics[width=\linewidth]{./logos/GeoSim_Logo}}
              \hfill
              \parbox[c]{0.10\linewidth}{\includegraphics[width=\linewidth]{./logos/UniPotsdam_Logo}}
              \hspace{2cm}
              }
\date[AGU~2017]{AGU Fall Meeting -- 13\textsuperscript{th} December 2017}

\begin{document}

\frame[noframenumbering, plain]
    {\maketitle}

\begin{frame}
    \frametitle{Outline -- Where are we driving at?}
    \framesubtitle{Surface Wave Tomography}

\begin{columns}
\column{.55\textwidth}
    proof of concept -- synthetic test

    Dispersion narrow frequency band
    Refraction great circle path

\column{.44\textwidth}
    \vspace{-15mm}
    \input{fig_reference_model.pgf}
\end{columns}

\end{frame}

\begin{frame}
    \frametitle{Travel Time Observations}
    \framesubtitle{Surface Wave Tomography}

\begin{columns}
\column{.55\textwidth}

    \begin{equation}
        d = \mathrm T_{s,r}[v] + \varepsilon = \int_C \frac 1{v(r)} \mathrm d r + \varepsilon
    \end{equation}

    \begin{description}[leftmargin=! ,labelwidth=6cm]
        \item [Actual observation]       $d$
        \item [Source location]          $s$
        \item [Receiver position]        $r$
        \item [Observational functional] $T_{s,r}[\cdot]$
        \item [Velocity model]           $v$
        \item [Ray path]                 $C$ great circle
        \item [Measurement error]        $\varepsilon$ white noise
    \end{description}

    \begin{alertblock}{It is the velocity model what we are after}
    $T_{s,r}$ puts an Integral-constraint on $v$
    \end{alertblock}

\column{.44\textwidth}
    \vspace{-15mm}
    \input{fig_path_coverage.pgf}

\end{columns}

\end{frame}

\begin{frame}
    \frametitle{A\,Priori Velocity Model}
    \framesubtitle{expressing our ignorance}

\begin{columns}
\column{.55\textwidth}

    \begin{equation}
        v \to V \sim \GP{\mu_V}{K_V}
    \end{equation}
    \begin{description}[leftmargin=! ,labelwidth=6cm]
        \item [A\,priori mean function] $\mu_V(x) = 4\,\frac ks$
        \item [Covariance function]     $K_V(x,y))$
    \end{description}
    \bigskip

    Correlation Kernel
    \begin{equation}
        K_V(x,y) = \tau^2 \exp\left\{ -\frac12 \frac{d(x,y)^2}{\ell^2}\right\}
    \end{equation}
    \begin{description}[leftmargin=! ,labelwidth=6cm]
        \item [Variance]              $\tau^2$
        \item [Great circle distance] $d(x,y)$
        \item [Characteristic lenth]  $\ell$
    \end{description}

\column{.44\textwidth}
    \vspace{-15mm}
    \input{fig_kernel.pgf}

\end{columns}

\end{frame}

\begin{frame}
    \frametitle{Linearization, Data Model and Discretization}
    \framesubtitle{to preserve Gaussianity}

\begin{columns}
\column{.55\textwidth}

    \begin{equation}
        T_{s,r}[v] \approx \int_C \frac 1{\mu_V(r)} - \frac{V(r)}{\mu_V(r)^2} \mathrm d r
    \end{equation}
    \begin{description}[leftmargin=!, labelwidth=1cm]
        \item [Taylor expansion] 1\textsuperscript{st} order
        \item [point of expansion] $\mu_V$
    \end{description}
    \bigskip

    Data Model
    \begin{equation}
        D = T + E \sim \Gauss{\mu_D}{\Sigma_{DD}}
    \end{equation}
    \begin{description}[]
        \item [Error model]        $\displaystyle E\sim \Gauss{0}{\sigma_\varepsilon^2}$
        \item [Prior travel times] $\displaystyle \mu_D = \Mean{T_{s,r}[\mu_V]}$
        \item [Covariance matrix]  $\displaystyle \Sigma_{DD} = \int_C \int_{\acute C} \frac{K_V(r,\acute r)}{\mu_V(r)^2\mu_V(\acute r)^2} \mathrm d r \mathrm d \acute r + \sigma_\varepsilon^2$
    \end{description}

\column{.44\textwidth}
    \vspace{-15mm}
    \input{fig_correlation.pgf}

\end{columns}

\end{frame}

\begin{frame}
    \frametitle{Bayesian Posterior Distribution}
    \framesubtitle{Gaussian Process Regression}

\begin{columns}
\column{.55\textwidth}
    \begin{alignat}{3}
        \Mean{V|d} &= \mu_V &&+ \Cov{V}{D} \Var{D}^{-1} \big( d - \Mean{D} \big)
        \\
        \Var{V|d}  &= K_V   &&- \Cov{V}{D} \Var{D}^{-1} \Cov{V}{D}
    \end{alignat}

    Approximate Correlations
    \begin{equation}
        \Cov{V}{D} \approx -\int_C \frac {K_V(\cdot,r)}{\mu_V(r)^2} \mathrm d r
    \end{equation}

    The posterior is built successively;
    will better account for non-linearity;
    single evidence at a time;
    correlations are obtained from predecessor;


\column{.44\textwidth}
    \vspace{-15mm}
    \input{fig_discretization.pgf}

\end{columns}

\end{frame}


\begin{frame}
    \frametitle{Successive Approach}
    \begin{center}
    \movie[height=0.9\textheight, width=1.6\textheight]{\includegraphics[height=0.9\textheight, width=1.6\textheight]{animation}}{animation.mp4}
    \end{center}
\end{frame}


\begin{frame}
    \frametitle{Outlook}

    succesion order;
    dispersion;
    kernel accounting for individual frequency bands
    real data;
    estimation of hyper parameters;

\end{frame}

\begin{frame}[c, noframenumbering, plain]
    \hspace{15mm} Follow the project on GitHub \\[1cm]
    \hfill \fbox{\qrcode[height=3cm]{https://github.com/mauimuc/gptt}} \hspace{20mm}
\end{frame}

\end{document}
